// ==UserScript==
// @name         标注广告
// @namespace    http://tampermonkey.net/
// @version      1.20250325.120549
// @description  加载不同的JS和CSS,标注广告
// @author       YLZ
// @match        *://*/*
// @icon         https://github.com/jqwel/extensions/blob/main/focus_booster/icon.png?raw=true
// @updateURL    https://raw.githubusercontent.com/jqwel/extensions/refs/heads/main/dist/focus_booster.meta.js
// @downloadURL  https://raw.githubusercontent.com/jqwel/extensions/refs/heads/main/dist/focus_booster.user.js
// @grant        GM_addStyle
// @grant        GM_addElement
// @grant        GM_xmlhttpRequest
// ==/UserScript==

!function(){"use strict";var e="{filter:blur(var(--blur-amount))!important;transition:filter var(--filter-transition-duration) var(--filter-transition-timing);overflow:hidden}",a="{filter:blur(0px)!important;overflow:visible}",o='{content:"广告";position:absolute;top:50%;left:50%;filter:blur(1px);transform:translate(-50%,-50%) rotate(-15deg);background:rgba(255,255,255,.12);color:rgba(204,56,56,.18);display:inline-flex;padding:8px 24px 16px 24px;border:5px solid rgba(204,62,62,.13);font-size:max(64px, min(32em, 120px));min-height:max(64px,min(32em,120px));line-height:max(64px, min(32em, 120px));font-family:STBaoliTC-Regular,LiSu,STLiti,cursive;border-radius:50%;z-index:99999;pointer-events:none;text-shadow:0 0 4px rgba(255,255,255,.29),0 0 8px rgba(255,255,255,.19),0 0 12px rgba(255,255,255,.19);white-space:nowrap;box-shadow:0 0 0 3px rgba(204,62,62,.15),inset 0 0 0 1px rgba(255,255,255,.1),0 0 2px rgba(204,62,62,.1),inset 0 0 5px rgba(204,62,62,.15)}';const i={js:"",css:':root{--blur-amount:10px;--filter-transition-duration:0.01s;--filter-transition-timing:ease-in-out;--content-ad-font-size:max((calc(min(7vw, 7vh, 512px)) + calc(min(10vw, 10vh) + 32px)) / 1.6, 32px)}.__focus_booster,.advertise,.pc-ad-common,a:has(> img[class*="-ad-"]),div:has(> iframe[src*="googleads.g.doubleclick.net/"]),div:has(> iframe[src^="//pos.baidu.com/"]),div:has(> iframe[src^="https://pos.baidu.com/"]),div:has(> img[class*="-ad-"]) a,div[id*="_ad_"],div[id^=google_ads_iframe_]'+e+'.__focus_booster:hover,.advertise:hover,.pc-ad-common:hover,a:has(> img[class*="-ad-"]):hover,div:has(> iframe[src*="googleads.g.doubleclick.net/"]):hover,div:has(> iframe[src^="//pos.baidu.com/"]):hover,div:has(> iframe[src^="https://pos.baidu.com/"]):hover,div:has(> img[class*="-ad-"]) a:hover,div[id*="_ad_"]:hover,div[id^=google_ads_iframe_]:hover'+a+'.__focus_booster::after,.advertise::after,.pc-ad-common::after,a:has(> img[class*="-ad-"])::after,div:has(> iframe[src*="googleads.g.doubleclick.net/"])::after,div:has(> iframe[src^="//pos.baidu.com/"])::after,div:has(> iframe[src^="https://pos.baidu.com/"])::after,div:has(> img[class*="-ad-"]) a::after,div[id*="_ad_"]::after,div[id^=google_ads_iframe_]::after'+o},d={".google.com":[".google.com.hk",".google.co.jp",".google.co.kr",".google.com.tw",".google.com",".google.ca",".google.com.au",".google.cn",".google.co.in",".google.com.sg",".google.co.id",".google.com.sa",".google.com.ph",".google.co.uk",".google.fr",".google.ru",".google.de",".google.it",".google.es",".google.co.za",".google.com.eg"],".msn.com":[".bing.com"]},s={".2345.com":{css:".xxl-ad-360,div:has(> .ad-mark)"+e+".xxl-ad-360:hover,div:has(> .ad-mark):hover"+a+".xxl-ad-360::after,div:has(> .ad-mark)::after"+o},".360.com":{css:".xxl-ad-360,div:has(> .ad-mark)"+e+".xxl-ad-360:hover,div:has(> .ad-mark):hover"+a+".xxl-ad-360::after,div:has(> .ad-mark)::after"+o},".baidu.com":{css:'#J-bottom-recommend-wrapper,.c-container:has(.ec-tuiguang):not(:has(div[data-cmatchid])),.clearfix>div:has(> .j_click_stats),.cr-content:has(.ec-tuiguang):not(:has(div[data-cmatchid])),.mediago-ad-wrapper,.newfcImgli:has(.fc-ad-tip),div[ad-dom-img=true],div[class^=unionAd_],div[data-cmatchid]:has(.ec-tuiguang),img[src*="//baikebcs.bdimg.com/adpic/"]'+e+'#J-bottom-recommend-wrapper:hover,.c-container:has(.ec-tuiguang):not(:has(div[data-cmatchid])):hover,.clearfix>div:has(> .j_click_stats):hover,.cr-content:has(.ec-tuiguang):not(:has(div[data-cmatchid])):hover,.mediago-ad-wrapper:hover,.newfcImgli:has(.fc-ad-tip):hover,div[ad-dom-img=true]:hover,div[class^=unionAd_]:hover,div[data-cmatchid]:has(.ec-tuiguang):hover,img[src*="//baikebcs.bdimg.com/adpic/"]:hover'+a+'#J-bottom-recommend-wrapper::after,.c-container:has(.ec-tuiguang):not(:has(div[data-cmatchid]))::after,.clearfix>div:has(> .j_click_stats)::after,.cr-content:has(.ec-tuiguang):not(:has(div[data-cmatchid]))::after,.mediago-ad-wrapper::after,.newfcImgli:has(.fc-ad-tip)::after,div[ad-dom-img=true]::after,div[class^=unionAd_]::after,div[data-cmatchid]:has(.ec-tuiguang)::after,img[src*="//baikebcs.bdimg.com/adpic/"]::after'+o},".bilibili.com":{css:'.ad-report,.bili-video-card__wrap:has(.bili-video-card__image--link[href*="cm.bilibili.com/cm/api"]),.bili-video-card__wrap:has(.bili-video-card__info--ad)'+e+'.ad-report:hover,.bili-video-card__wrap:has(.bili-video-card__image--link[href*="cm.bilibili.com/cm/api"]):hover,.bili-video-card__wrap:has(.bili-video-card__info--ad):hover'+a+'.ad-report::after,.bili-video-card__wrap:has(.bili-video-card__image--link[href*="cm.bilibili.com/cm/api"])::after,.bili-video-card__wrap:has(.bili-video-card__info--ad)::after'+o},".bing.com":{css:".sb_adTA"+e+".sb_adTA:hover"+a+".sb_adTA::after"+o},".duckduckgo.com":{css:"li[data-layout=ad]"+e+"li[data-layout=ad]:hover"+a+"li[data-layout=ad]::after"+o},".facebook.com":{css:'.x1yztbdb:has(a[href^="/ads/about/?"]),div[role=complementary] a[aria-label="广告主"]'+e+'.x1yztbdb:has(a[href^="/ads/about/?"]):hover,div[role=complementary] a[aria-label="广告主"]:hover'+a+'.x1yztbdb:has(a[href^="/ads/about/?"])::after,div[role=complementary] a[aria-label="广告主"]::after'+o},".google.com":{css:'div[data-text-ad="1"]'+e+'div[data-text-ad="1"]:hover'+a+'div[data-text-ad="1"]::after'+o},".ifeng.com":{css:'#viewDiv:has(img[src*="x0.ifengimg.com/feprod/c/feprod/c/ifengimcp/pic/20210108/3677f2773fd79f12b079_size1_w56_h34.png"]),.news-stream-newsStream-news-item-ad,:is(div,a):not([class^=text-]):has(> img[src*="/feprod/c/ifengimcp/pic/20210108/3677f2773fd79f12b079_size1_w56_h34.png"]),:is(div,li):has(> iframe[src*="www.ifeng.com/a_if/baidu/"]),div:has(> iframe[src*="www.ifeng.com/a_if/iis/baidu/"]),div:has(> img[src*="//x0.ifengimg.com/feprod/c/2023_1_17/16_21_21/1.png"]),div[class*=index_ad],div[class*=index_asideAd],div[class*=index_bottomAd],div[class*=index_contentBottomAd],div[class*=index_floatAd],div[class*=index_hardAd],div[class*=index_rectangleAd],div[class*=index_serviceAd],div[class*=index_topAd],newsfeed:has(.adTag)'+e+'#viewDiv:has(img[src*="x0.ifengimg.com/feprod/c/feprod/c/ifengimcp/pic/20210108/3677f2773fd79f12b079_size1_w56_h34.png"]):hover,.news-stream-newsStream-news-item-ad:hover,:is(div,a):not([class^=text-]):has(> img[src*="/feprod/c/ifengimcp/pic/20210108/3677f2773fd79f12b079_size1_w56_h34.png"]):hover,:is(div,li):has(> iframe[src*="www.ifeng.com/a_if/baidu/"]):hover,div:has(> iframe[src*="www.ifeng.com/a_if/iis/baidu/"]):hover,div:has(> img[src*="//x0.ifengimg.com/feprod/c/2023_1_17/16_21_21/1.png"]):hover,div[class*=index_ad]:hover,div[class*=index_asideAd]:hover,div[class*=index_bottomAd]:hover,div[class*=index_contentBottomAd]:hover,div[class*=index_floatAd]:hover,div[class*=index_hardAd]:hover,div[class*=index_rectangleAd]:hover,div[class*=index_serviceAd]:hover,div[class*=index_topAd]:hover,newsfeed:has(.adTag):hover'+a+'#viewDiv:has(img[src*="x0.ifengimg.com/feprod/c/feprod/c/ifengimcp/pic/20210108/3677f2773fd79f12b079_size1_w56_h34.png"])::after,.news-stream-newsStream-news-item-ad::after,:is(div,a):not([class^=text-]):has(> img[src*="/feprod/c/ifengimcp/pic/20210108/3677f2773fd79f12b079_size1_w56_h34.png"])::after,:is(div,li):has(> iframe[src*="www.ifeng.com/a_if/baidu/"])::after,div:has(> iframe[src*="www.ifeng.com/a_if/iis/baidu/"])::after,div:has(> img[src*="//x0.ifengimg.com/feprod/c/2023_1_17/16_21_21/1.png"])::after,div[class*=index_ad]::after,div[class*=index_asideAd]::after,div[class*=index_bottomAd]::after,div[class*=index_contentBottomAd]::after,div[class*=index_floatAd]::after,div[class*=index_hardAd]::after,div[class*=index_rectangleAd]::after,div[class*=index_serviceAd]::after,div[class*=index_topAd]::after,newsfeed:has(.adTag)::after'+o},".msn.com":{js:'var cssPath="";try{chrome&&(cssPath=chrome.runtime.getURL("css/all.css"))}catch{}cssPath||(cssPath="https://raw.githubusercontent.com/jqwel/extensions/refs/heads/main/focus_booster/css/all.css");var link=document.createElement("link");link.rel="stylesheet",link.href=cssPath;var nodeMap={},SheetLoaded=null;async function handleShadowRoots(o=document.body){o||console.error(o);findAllShadowRoots(o).forEach((o=>{if(!nodeMap[o]){nodeMap[o]=!0;new MutationObserver((e=>{debouncedHandleShadowRoots(o)})).observe(o,{childList:!0,subtree:!0})}findDivsWithAdSlugAndContent(o).forEach((e=>{if(!o._focus_boost_insert){o._focus_boost_insert=!0,async function(){if(!SheetLoaded){const o=new CSSStyleSheet;SheetLoaded=o;const e=await fetch(cssPath),t=await e.text();o.replaceSync(t)}o.adoptedStyleSheets.push(SheetLoaded)}()}o.insertBefore(link,o.firstChild),e.classList.contains("__focus_booster")||e.classList.add("__focus_booster")}))}))}function findAllShadowRoots(o){const e=[];return o.shadowRoot&&(e.push(o.shadowRoot),e.push(...findAllShadowRoots(o.shadowRoot))),o.childNodes.forEach((o=>{e.push(...findAllShadowRoots(o))})),e}const debouncedHandleShadowRoots=handleShadowRoots,observer=new MutationObserver((o=>{debouncedHandleShadowRoots(document.body)}));function findDivsWithAdSlugAndContent(o){const e=[];return[".card-outer:has(.ad-slug)",".card-content:has(.ad-slug)",".content-card-container:has(.ad-label)"].forEach((t=>{o.querySelectorAll(t).forEach((o=>{e.push(o)}))})),e}observer.observe(document.body,{childList:!0,subtree:!0}),nodeMap[document.body]=!0,handleShadowRoots(document.body),setInterval(debouncedHandleShadowRoots,600);',css:"/deep/cs-content-card[data-t*=NativeAd]"+e+"/deep/cs-content-card[data-t*=NativeAd]:hover"+a+"/deep/cs-content-card[data-t*=NativeAd]::after"+o},".mydrivers.com":{css:".good_ths li,li:has(.c)"+e+".good_ths li:hover,li:has(.c):hover"+a+".good_ths li::after,li:has(.c)::after"+o+"body{background-color:#000!important}"},".163.com":{css:".ad_text,.common_ad_item,.hp_textlink1_ad,.idx_kaola_ad,.mod_js_ad,.post_recommend_ad,.right_ad_item"+e+".ad_text:hover,.common_ad_item:hover,.hp_textlink1_ad:hover,.idx_kaola_ad:hover,.mod_js_ad:hover,.post_recommend_ad:hover,.right_ad_item:hover"+a+".ad_text::after,.common_ad_item::after,.hp_textlink1_ad::after,.idx_kaola_ad::after,.mod_js_ad::after,.post_recommend_ad::after,.right_ad_item::after"+o},".qq.com":{css:".ad-cell-common,.channel-feed-item:has(.adCode),.rectangle-ad-channel,div[adconfig_key]"+e+".ad-cell-common:hover,.channel-feed-item:has(.adCode):hover,.rectangle-ad-channel:hover,div[adconfig_key]:hover"+a+".ad-cell-common::after,.channel-feed-item:has(.adCode)::after,.rectangle-ad-channel::after,div[adconfig_key]::after"+o},".reddit.com":{js:"",css:".promotedlink"+e+".promotedlink:hover"+a+".promotedlink::after"+o},".sina.com.cn":{css:".sinaads-float,.sinaads:not(.sinaads-fail),div:has(> iframe[adtypeturning=undefined]),div[id*=sinaadToolkitBox]"+e+".sinaads-float:hover,.sinaads:not(.sinaads-fail):hover,div:has(> iframe[adtypeturning=undefined]):hover,div[id*=sinaadToolkitBox]:hover"+a+".sinaads-float::after,.sinaads:not(.sinaads-fail)::after,div:has(> iframe[adtypeturning=undefined])::after,div[id*=sinaadToolkitBox]::after"+o},".so.com":{css:".e-buss li"+e+".e-buss li:hover"+a+".e-buss li::after"+o},".sogou.com":{css:"#ad-top-static-banner,#ad_result_right,#opening-ad,.ad-icon-side-banner,.art-container:has(.feed-item-close),.sdk-ad,.sdk-ad-side-banner-hover,.sponsored-ams>div,[class^=shopWindow_shopWindowAd]:not([class^=shopWindow_shopWindowAd] [class^=shopWindow_shopWindowAd]),a[dt-eid=ads_top]"+e+"#ad-top-static-banner:hover,#ad_result_right:hover,#opening-ad:hover,.ad-icon-side-banner:hover,.art-container:has(.feed-item-close):hover,.sdk-ad-side-banner-hover:hover,.sdk-ad:hover,.sponsored-ams>div:hover,[class^=shopWindow_shopWindowAd]:not([class^=shopWindow_shopWindowAd] [class^=shopWindow_shopWindowAd]):hover,a[dt-eid=ads_top]:hover"+a+"#ad-top-static-banner::after,#ad_result_right::after,#opening-ad::after,.ad-icon-side-banner::after,.art-container:has(.feed-item-close)::after,.sdk-ad-side-banner-hover::after,.sdk-ad::after,.sponsored-ams>div::after,[class^=shopWindow_shopWindowAd]:not([class^=shopWindow_shopWindowAd] [class^=shopWindow_shopWindowAd])::after,a[dt-eid=ads_top]::after"+o},".v2ex.com":{css:".wwads-cn"+e+".wwads-cn:hover"+a+".wwads-cn::after"+o},".weibo.com":{css:'.vue-recycle-scroller__item-view:has(.wbpro-tag-img),.vue-recycle-scroller__item-view:has([mark*="_mark_ad:"]),:is([class*=" TipsAd_picture_"],[class^=TipsAd_picture_])'+e+'.vue-recycle-scroller__item-view:has(.wbpro-tag-img):hover,.vue-recycle-scroller__item-view:has([mark*="_mark_ad:"]):hover,:is([class*=" TipsAd_picture_"],[class^=TipsAd_picture_]):hover'+a+'.vue-recycle-scroller__item-view:has(.wbpro-tag-img)::after,.vue-recycle-scroller__item-view:has([mark*="_mark_ad:"])::after,:is([class*=" TipsAd_picture_"],[class^=TipsAd_picture_])::after'+o},".x.com":{css:"div[data-testid=placementTracking]:has([data-testid*=impression])"+e+"div[data-testid=placementTracking]:has([data-testid*=impression]):hover"+a+"div[data-testid=placementTracking]:has([data-testid*=impression])::after"+o},".youtube.com":{css:"#masthead-ad:not(:has(ytd-ad-slot-renderer)),#player-ads,ytd-ad-slot-renderer"+e+"#masthead-ad:not(:has(ytd-ad-slot-renderer)):hover,#player-ads:hover,ytd-ad-slot-renderer:hover"+a+"#masthead-ad:not(:has(ytd-ad-slot-renderer))::after,#player-ads::after,ytd-ad-slot-renderer::after"+o}};for(let e of Object.keys(d)){var t=d[e];if(t)for(let a of t)a&&(s[a]=s[e])}n(i.js),l(i.css);const r=window.location.hostname,c=Object.keys(s).find((e=>e.length>0&&"."===e[0]&&e.substring(1)===r||r.endsWith(e)));if(c){const e=s[c];e.js&&n(e.js),e.css&&l(e.css)}function n(e){if(e)if(e.startsWith("http"))GM_xmlhttpRequest({method:"GET",url:e,headers:{"User-Agent":"Mozilla/5.0"},onload:function(e){let a=document.createElement("script");a.textContent=e.responseText,document.head.appendChild(a)},onerror:function(e){console.error("JS 请求失败:",e)}});else{let a=document.createElement("script");a.textContent=e,document.head.appendChild(a)}}function l(e){if(e)if(e.startsWith("http"))GM_xmlhttpRequest({method:"GET",url:e,headers:{"User-Agent":"Mozilla/5.0"},onload:function(e){let a=document.createElement("style");a.textContent=e.responseText,document.head.appendChild(a),h(a,document.head)},onerror:function(e){console.error("CSS 请求失败:",e)}});else{let a=document.createElement("style");a.textContent=e,document.head.appendChild(a,document.head),h(a)}}function h(e,a){a||(a=document.head);const o=new MutationObserver((()=>{a.contains(e)||location.hostname!==i||a.appendChild(e)})),i=location.hostname;o.observe(a,{childList:!0})}}();